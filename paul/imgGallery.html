<!DOCTYPE html>
<html>

<head>
  <title>PHASE 2</title>
  <style>
    .heading {
      color: blue;
    }

    .pctImg {
      width: 100%;
      height: auto;
    }

    .imgDiv {
      /* width: 30%;  */
      /* height: 300px; */
      padding: 5px;
    }

    .gridContainer {
      display: grid;
      grid-gap: 3px;
      grid-template-columns: 33% 33% 33%;
    }
  </style>
</head>

<body>
  <h1 class="heading">Paul Lee - Phase 3 Image Gallery</h1>
  <div class='gridContainer'></div>

  <script>
    var images = ["1.jpg", "2.jpg", "3.jpg", "4.jpg", "5.jpg", "6.jpg"];
    var titles = ['Oldy car 1', 'Old car 2', 'Old car 3', 'Old car 4', 'Old civic 5', 'old civic 6'];
    var descriptions = ['This looks like an old car. Its brown!',
      'This is an old car number 2',
      'This is the third old car',
      'This is the 4th olde car',
      'This is old car number 5',
      'This is the last old civic car number 6'
    ];

    // console.log(images);
    // console.log(titles);
    // console.log(descriptions);

    var url;
    var urlOfDetailPage;
    var title;
    var description;

    for (var i = 0; i < images.length; i++) {
      var h2 = document.createElement("h2");
      var p = document.createElement("p");

      var h2Text = document.createTextNode(titles[i]);
      var pText = document.createTextNode(descriptions[i]);

      h2.appendChild(h2Text);
      p.appendChild(pText);




      //console.log("image in iteration is " + images[i]);

      url = 'https://s3.amazonaws.com/fedphase2gallery/' + images[i];
      title = '&title=' + titles[i];
      description = '&description=' + descriptions[i];

      // url of detail page
      urlOfDetailPage = "https://s3.amazonaws.com/fedphase2gallery/galleryDetail.html?" + "img=" + url + title +
        description;

      // urlOfDetailPage = "./galleryDetail.html?" + "img=" + url + title + description;

      var imgDiv = document.createElement("div");
      imgDiv.setAttribute("class", "imgDiv");
      var imgInDiv = document.createElement("img");
      imgInDiv.setAttribute("class", "pctImg");
      imgInDiv.setAttribute("src", url);
      var link = document.createElement("a");
      link.setAttribute("href", urlOfDetailPage);
      link.appendChild(imgInDiv);
      imgDiv.appendChild(link);

      var btn1 = document.createElement("button");
      var btn2 = document.createElement("button");

      (function(){
        var x = i;
        btn1.addEventListener('click', function() {
          console.log('car_'+x)
          setCookie("car_"+x, url, 30);
        });

        btn2.addEventListener('click', function() {
          deleteCookie("car_"+x);
        });
      })()

      var btnText1 = document.createTextNode('Make Favorite');
      var btnText2 = document.createTextNode('Unfavorite');

      btn1.appendChild(btnText1);
      btn2.appendChild(btnText2);
      imgDiv.appendChild(h2);
      imgDiv.appendChild(p);
      
      var theCookie = getCookie('car_' + i);
      if (theCookie) {
        var div1 = document.createElement('div');
        var divText = document.createTextNode('favorited');
        div1.appendChild(divText);
        imgDiv.appendChild(div1)
      } else {
        imgDiv.appendChild(btn1);
      }
      imgDiv.appendChild(btn2);

      document.getElementsByClassName('gridContainer')[0].appendChild(imgDiv);
    }

    function setCookie(cname, cvalue, exdays) {
      var d = new Date();
      d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
      var expires = "expires=" + d.toGMTString();
      document.cookie = cname + "=" + cvalue + "; " + expires;
    }

    function getCookie(cname) {
      var name = cname + "=";
      var ca = document.cookie.split(';');
      for (var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') c = c.substring(1);
        if (c.indexOf(name) == 0) {
          return c.substring(name.length, c.length);
        }
      }
      return "";
    }

    function checkCookie() {
      var user = getCookie("username");
      if (user != "") {
        alert("Welcome again " + user);
      } else {
        user = prompt("Please enter your name:", "");
        if (user != "" && user != null) {
          setCookie("username", user, 30);
        }
      }
    }

    function deleteCookie( name ) {
      document.cookie = name + '=; expires=Thu, 01 Jan 1970 00:00:01 GMT;';
    }
  </script>
</body>

</html>